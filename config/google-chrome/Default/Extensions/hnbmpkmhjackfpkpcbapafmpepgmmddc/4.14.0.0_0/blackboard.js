var env={};var data={};var student_id,session_id,exam_id,display_count;var school_code,exam_name,exam_toggles,bypass_status=0;let launch_screen;let translations;detectPage();function detectPage(){let pagecount=0;let page_identified=null;let current_page=window.location.href;let page_identifiers={quiz_instructions:/\bwebapps\/assessment\/take\/launchAssessment\.jsp\b/i.test(current_page),quiz_password:/^(?!.*isPasswordAttempted).*\bwebapps\/assessment\/take\/launch\.jsp\b\?\bcourse_assessment_id\b.*\bcourse_id\b.*\bcontent_id\b.*\b/i.test(current_page),quiz_question:/\bwebapps\/assessment\/take\/take\.jsp\b\?/i.test(current_page),quiz_submitted:/\bwebapps\/assessment\/take\/submitted\.jsp\b\?/i.test(current_page),ambiguous:/\bwebapps\/assessment\/take\/launch\.jsp\b\?\bcourse_assessment_id\b.*\bcourse_id\b.*\bcontent_id\b.*\bisPasswordAttempted\b.*\b/i.test(current_page)};$.each(page_identifiers,(function(key,value){if(value){page_identified=key;pagecount++}}));if(1===pagecount)applyPageLogic(page_identified)}chrome.runtime.sendMessage({message:"exam_tab_id"});chrome.runtime.sendMessage({message:"is_exam_paused"},(function(response){if(1==response.bypass_status)return;if("paused"==response.exam_state)pauseAllTabs(response.pause_reasons)}));function pauseAllTabs(reason,relaunch=false){chrome.runtime.sendMessage({message:"pause_all_tabs",reason:[reason],relaunch:relaunch})}function resumeAllTabs(){setTimeout((function(){chrome.runtime.sendMessage({message:"resume_all_tabs"})}),750)}function applyPageLogic(page){switch(page){case"quiz_instructions":applyInstructionLogic();break;case"quiz_password":applyLaunchLogic();break;case"quiz_question":applyRunLogic();break;case"quiz_submitted":applySubmitLogic();break;case"ambiguous":waitForElement("#dataCollectionContainer",(function(callback){if(callback)$("#step1").length?applyLaunchLogic():applyRunLogic()}));break;default:}}function applyInstructionLogic(){waitForElement("#hl_frame",(function(callback){if(callback){var iframe=$("#hl_frame");if(iframe)iframe.hide();var beginBtn=$('input[type="submit"][name="bottom_Begin"], input[type="submit"][name="bottom_Continue"]');beginBtn.css("opacity","1.0");beginBtn.css("pointer-events","");beginBtn.prop("disabled",false);if("bottom_Continue"===beginBtn.attr("name"))beginBtn.on("click touchstart",resumeQuiz)}}))}function showInstructionsFrame(){$("#hl_frame").show();let button_names=["bottom_Begin","bottom_Continue"];for(let button_name of button_names){let button=$(`input[name="${button_name}"]`);button.css("opacity","0.5");button.css("pointer-events","none");button.prop("disabled",true)}}function resumeQuiz(){chrome.storage.local.get(null,(storage=>{if(!storage.exam_state||"submitted"===storage.exam_state)return;$.ajax({type:"POST",url:storage.app_url+"/lms/resume_quiz",beforeSend:function(xhr){xhr.setRequestHeader("Authorization","Bearer "+storage.usat)},data:{lms_user_id:storage.lms_student_id,lms_school_id:storage.lms_school_id,lms_exam_id:storage.lms_exam_id},async:false})}))}function webcamOpenMessage(){$(".hl-begin-header").html(translations.authentication.begin_header);$("#hl-begin-instructions").html(translations.blackboard.begin_instructions);$("#relaunch-proctoring").click((function(){$(this).css("color","#540baf");launchWebCamera()}))}function submitAccessCode(exam_access_code){exam_access_code=exam_access_code.substring(0,exam_access_code.length-2);$('div.field > input[type="password"]').val(exam_access_code).prop("type","hidden");$('input[name="bottom_Submit"]').trigger("click")}function launchWebCamera(){if(1==bypass_status)requestAccessCode();else chrome.runtime.sendMessage({message:"webcam_launch",url:hl_url+"/webapp/camera",session_id:session_id,lms_id:1,relaunch:0,display_count:display_count,current_url:window.location.hostname})}function relaunchWebCamera(){pauseAllTabs(translations.webcam.relaunch,true)}function applyLaunchLogic(){waitForElement("#dataCollectionContainer",(function(callback){if(callback&&"none"!=$("#step1").css("display")){displayLoader();getEnvInfo((function(){studentInit()}))}}));chrome.extension.onMessage.addListener((function(msg,sender,sendResponse){if("webcam_open"==msg.action)webcamOpenMessage();else if("display_count"==msg.action)display_count=msg.data;else if("test_ready"==msg.action)submitAccessCode(msg.data);else if("webcam_closed_begin"==msg.action){if("1"==exam_toggles[14].value)chrome.runtime.sendMessage({message:"disable_browser_guard"})}else if("focus_test"===msg.action)chrome.runtime.sendMessage({message:"focus_page"});else if("checklist_complete"==msg.action){var data={lms_id:1,exam_id:exam_id,student_id:student_id,session_id:session_id,exam_name:exam_name,school_code:school_code};sendResponse(data)}else if("send_chat"===msg.action)sendLivechatMsg(msg.message);else if("showcalculator"===msg.action||"showcalculatorsci"===msg.action){const calculatorType="showcalculator"===msg.action?"basic":"scientific";showCalculator(calculatorType)}else if("opencalculator"===msg.action||"opencalculatorsci"===msg.action)toggleCalculator(true);else if("hidecalculators"===msg.action)hideCalculators();else if("closecalculators"===msg.action)toggleCalculator(false,false);else if("open_support_chat"===msg.action){hlChat.destroy();hlChat.setGroupId(msg.group_id);hlChat.injectCode();hlChat.maximizeWindow()}else if("show_exam_webcam"===msg.action)insertExamTools(true);else if("showwebcam"===msg.action)toggleWebcamVisibilty(true);else if("hidewebcam"===msg.action)toggleWebcamVisibilty(false);else if("compresswebcam"===msg.action)toggleWebcamCompressed(true);else if("expandwebcam"===msg.action)toggleWebcamCompressed(false)}));function displayLoader(){$("#step1").before('<div id="hl-loader"><p>Loading</p><div class="hl-bounce1"></div><div class="hl-bounce2"></div><div class="hl-bounce3"></div></div>');$("#step1").hide();$(".submitStepBottom").hide();setTimeout((function(){if(!$("#hl-begin").length){$("#step1").show();$(".submitStepBottom").show();$("#hl-loader").remove()}}),1e4)}function studentInit(){var billable=1;if($("div#student-preview-ribbon").length&&"none"!=$("div#student-preview-ribbon").css("display"))billable=0;if($("div.modeSwitchWrap").length)billable=0;if("S"==env.user.CourseRole)billable=1;let data={lms_id:1,lms_school_id:env.school.id||env.context.VirtualHostKey,lms_exam_id:env.content.id,lms_student_id:env.user.UserName,lms_student_email:env.user.Email,lms_student_name:env.user.GivenName+" "+env.user.FamilyName,lms_student_first_name:env.user.GivenName,lms_student_last_name:env.user.FamilyName,href:window.location.href,user_agent:navigator.userAgent,billable:billable,ext_version:chrome.runtime.getManifest().version,browser_version:getChromeVersion(),is_resumed_exam:window.location.href.indexOf("new_attempt=1")>=0?0:1};chrome.runtime.sendMessage({message:"lms_init",data:data},(function(r){if(r.result){var response=r.response;if(1==response.status){exam_id=response.exam_id;student_id=response.student_id;session_id=response.session_id;hl_student_id=response.student_id;bypass_status=response.bypass_status;school_code=response.school_code;exam_toggles=response.exam_toggles;exam_name=response.exam_name;env.exam_instructions=response.exam_instructions;launch_screen=response.launch_screen;translations=response.translations;if(exam_toggles)if(void 0==exam_toggles[28])exam_toggles[28]={id:28,value:"0"};if(1===bypass_status)requestAccessCode();else{hideAccessCode();displayLaunchUI(hl_student_id);if(exam_toggles&&"1"==exam_toggles[12]["value"])chrome.runtime.sendMessage({message:"display_count"})}}else showAccessCode()}else{student_id="";session_id="";showAccessCode()}}));function displayLaunchUI(hl_student_id){$("#step1").before('<div id="hl-begin" class="hl-begin" style="display: none;"></div>');$("#hl-begin").prepend(launch_screen);$(".hl-begin").fadeIn("slow");$("#pageTitleText, li.placeholder").text((function(){return $(this).text().replace("Enter Password: ","")}));insertLaunchSidebar("");hlUserAgreement.init(launchWebCamera);hlUserAgreement.setTranslations(translations);insertLiveChat(env.user.GivenName+" "+env.user.FamilyName,hl_student_id,exam_id,school_code,"launch",exam_toggles)}}function hideAccessCode(){$("#step1").hide();$(".submitStepBottom").hide();if($("#hl-loader").length)$("#hl-loader").remove()}function showAccessCode(){$("#step1").show();$(".submitStepBottom").show();if($("#hl-loader").length)$("#hl-loader").remove()}function requestAccessCode(bypass_set=1){var data={lms_id:1,exam_id:exam_id,session_id:session_id,exam_name:exam_name,school_code:school_code};chrome.runtime.sendMessage({message:"access_request",data:data,bypass_set:bypass_set});if(!bypass_set)$("input#hl-pin").prop("type","hidden")}document.addEventListener("launchcam",(function(){launchWebCamera()}));function insertLaunchSidebar(){insertWebFont();var menu_items={livechat:{id:"hl-livechat-link",class:"far fa-comments",title:translations.live_chat,action:void 0},guide:{id:"hl-guide",class:"far fa-file-pdf",title:translations.guide,action:function(){chrome.runtime.sendMessage({message:"open_blackboard_guide",lms_current_url:document.referrer})}},accessibility:{id:"hl-accessibility",class:"fas fa-key",title:translations.accessibility,action:function(){$("li#hl-accessibility-field").slideToggle()}}};$("#hl-menu").remove();$("#hl-begin").append(`<div id="hl-menu"><div class="menu-title"><span>${translations.proctoring_support}</span></div><div><ul class="hl-support-list"></ul></div>`);$.each(menu_items,(function(key,item){const $hlSupportList=$("ul.hl-support-list");$hlSupportList.append('<li id="'+item["id"]+'"><i class="'+item["class"]+'"></i>'+item["title"]+"</li>");if(item["action"]&&"function"===typeof item["action"])$("li#"+item["id"]).on("click touchstart",item["action"]);if("Accessibility"===item["title"])$hlSupportList.append(`<li id="hl-accessibility-field"><div><span>${translations.accessibility_code_label}</span><input id="hl-pin" type="password" aria-label="${translations.accessibility_code_al}" maxlength=5></div></li>`)}));accessibilityPINListener();$("#hl-menu").fadeIn("slow")}function accessibilityPINListener(){$("#hl-pin").keyup((async function(){var pin_color="black";var pin_value=$(this).val();if(5==pin_value.length){const usat=await getUsat().finally((usat=>usat));$.ajax({url:hl_url+"/lms/bypasspincheck",beforeSend:function(xhr){xhr.setRequestHeader("Authorization","Bearer "+usat)},data:{pin:pin_value,student_id:student_id,lms_student_id:env.user.UserName,lms_student_name:env.user.GivenName+" "+env.user.FamilyName,ext_version:chrome.runtime.getManifest().version},type:"POST",async:false,success:function(response){if("1"==response)chrome.storage.local.set({bypass_status:1},(()=>{pin_color="green";bypass_status=1;requestAccessCode(0);chrome.runtime.sendMessage({message:"close_all_webcam_windows"})}));else if("2"==response)pin_color="orange";else pin_color="red"}}).fail((function(jQueryXHR,exception){pin_color="grey"}))}$("#hl-pin").css("color",pin_color)}))}}function applyRunLogic(){chrome.extension.onMessage.addListener((function(msg,sender,sendResponse){if("relaunch_webcam"===msg.action){chrome.runtime.sendMessage({message:"focus_page"});relaunchWebCamera()}else if("focus_test"===msg.action)chrome.runtime.sendMessage({message:"focus_page"});else if("showcalculator"===msg.action||"showcalculatorsci"===msg.action){const calculatorType="showcalculator"===msg.action?"basic":"scientific";showCalculator(calculatorType)}else if("hidecalculators"===msg.action)hideCalculators()}));var disable_page_actions,current_question;var came_from_launch=window.location.href.indexOf("launch.jsp")>0?true:false;waitForElement(".takeQuestionDiv",(function(){getEnvInfo((function(){chrome.storage.local.get(null,(storage=>{if(!storage.exam_state||"submitted"==storage.exam_state)return;exam_id=storage.exam_id;student_id=storage.student_id;session_id=storage.session_id;exam_toggles=storage.exam_toggles;env.school_code=storage.school_code;env.current_attempt=storage.student_attempt;translations=storage.translations;if(exam_toggles)if(void 0==exam_toggles[28])exam_toggles[28]={id:28,value:"0"};if(storage.bypass_status)return;trackWindowClose();if(!!Number(exam_toggles[2]["value"])){let iframe=$('iframe[id="essay-ans-_58_1text_ifr"]').contents();elements=[$("body"),$(".takeQuestionDiv"),$("iframe").contents()];trackEvent(elements)}formatLinks();chrome.runtime.sendMessage({message:"check_webcam"});current_question=jQuery(".takeQuestionDiv").eq(0);let all_at_once=jQuery(".takeQuestionDiv").length>1?true:false;if(all_at_once){$("div.takeQuestionDiv").find('input[type="radio"]').click((function(e){let question_answered=$(this).closest("div.takeQuestionDiv");postLog("Load",question_answered)}));setInterval((function(){chrome.runtime.sendMessage({message:"check_webcam"})}),3e4)}else postLog("Load",current_question);if(exam_toggles){disable_page_actions=exam_toggles[2]["value"]||null;let disable_printing=exam_toggles[9]["value"]||null;if("1"==disable_printing){var print_style=document.createElement("style");print_style.media="print";print_style.appendChild(document.createTextNode("body { visibility: hidden !important; display: none !important; }"));document.head.appendChild(print_style)}const showCalculator=1===parseInt(exam_toggles[19]["value"])||1===parseInt(exam_toggles[28]["value"]);var append_menu=$("#pageTitleDiv");if(append_menu){const calculatorButton=`<button id="hl-calculator" style="display: ${showCalculator?"inline-block":"none"}; margin-left: 14px;" class="button-4">${translations.blackboard.show_calculator}</button>`;append_menu.append(`\n\t\t\t\t\t\t\t<div style="float: right; padding-right: 10px; display: inline-block">\n\t\t\t\t\t\t\t\t<div style="display:inline-block">${translations.blackboard.proctoring}</div>\n\t\t\t\t\t\t\t\t<button id="hl-livechat-link" style="display:inline-block" class="button-4">${translations.blackboard.live_chat}</button>\n\t\t\t\t\t\t\t\t${calculatorButton}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);$("#hl-calculator").on("click touchstart",(()=>toggleCalculator()))}insertExamTools(false);if("object"===typeof hlIdleBrowserCapture)hlIdleBrowserCapture.init({translations:translations});chrome.runtime.sendMessage({message:"inject_shortcut_detection",type:"browser_guard"})}insertLiveChat(env.user.GivenName+" "+env.user.FamilyName,student_id,exam_id,env.school_code,"run",exam_toggles)}))}))}));function trackEvent(elements){if("undefined"!==typeof hlAlert)hlAlert.init();let eventsReadable={dragstart:translations.forbidden_events.dragstart,contextmenu:translations.forbidden_events.contextmenu,copy:translations.forbidden_events.copy,paste:translations.forbidden_events.paste,cut:translations.forbidden_events.cut};let eventsLogged={dragstart:"Drag and Drop",contextmenu:"Right Click",copy:"Copy",paste:"Paste",cut:"Cut"};elements.forEach((element=>{["contextmenu","dragstart","copy","paste","cut"].forEach((event=>{element.bind(event,(e=>{e.preventDefault();let capitalize=([firstLetter,...restOfWord])=>firstLetter.toUpperCase()+restOfWord.join("");let eventDisplayed=eventsReadable[event]?eventsReadable[event]:capitalize(event);if(!element.hasClass("takeQuestionDiv")&&"undefined"!==typeof hlAlert)hlAlert.showAlert("exam",eventDisplayed,null,{timeout:3e3});postLog(eventsLogged[event],element)}))}))}))}function postLog(event_type,question){let question_text=question.find("legend.legend-visible div.vtbegenerated").text().trim();let question_html=question.find("legend.legend-visible div.vtbegenerated").html();let question_num=question.find("h3.steptitle").length?question.find("h3.steptitle").text():question.parent().children("h3.rumble_top").text();let data={lms_id:1,event_type:event_type,question_num:question_num.trim(),question_text:question_text,question_html:question_html,school_identifier:env.school.id||env.context.VirtualHostKey,exam_identifier:env.content.id,student_identifier:env.user.UserName,user_name:env.user.GivenName+" "+env.user.FamilyName,current_attempt:env.current_attempt||"",came_from_launch:came_from_launch,location:window.location.href,hl_student_id:student_id};chrome.runtime.sendMessage({message:"lms_log",data:data})}function trackWindowClose(){const formContainer=$("#bb-take-assessment");let isLastElementLinkingQuestion=false;let isLastElementSubmittingExam=false;let isExamExpiring=false;let isExamExpired=false;$('a, button, input.submit, input[type="submit"]').on("click touchstart",(function(){const lastElement=$(this);isLastElementLinkingQuestion=lastElementLinksToQuestions(lastElement);isLastElementSubmittingExam=lastElementSubmitsExam(lastElement)}));function lastElementLinksToQuestions(lastDomElement){return lastDomElement&&formContainer.has(lastDomElement)&&(lastDomElement.hasClass("pagelink")||lastDomElement.hasClass("abutton"))}function lastElementSubmitsExam(lastDomElement){const inputValue=lastDomElement.val();return lastDomElement&&("submit"===lastDomElement.attr("type")||lastDomElement.hasClass("submit"))&&(inputValue?-1===inputValue.toLowerCase().indexOf("close"):true)}function examIsExpiring(timeWarning){return timeWarning.indexOf("30 seconds")>=0}function examHasExpired(timeWarning){return timeWarning.indexOf("time expired")>=0}function handleBeforeUnloadEvent(){const timeWarningContainer=document.getElementById("timeWarningDiv");const timeWarning=timeWarningContainer?timeWarningContainer.innerText.toLowerCase():"";isExamExpiring=examIsExpiring(timeWarning);isExamExpired=examHasExpired(timeWarning);if(isLastElementLinkingQuestion&&!isExamExpiring&&!isExamExpired)return;if(isLastElementSubmittingExam||isExamExpiring||isExamExpired){postLog("Exam Submit",current_question);chrome.runtime.sendMessage({message:"disable_browser_guard"});chrome.runtime.sendMessage({message:"close_webcam",type:"submit"});return}postLog("Exam Browser Closed",current_question);chrome.runtime.sendMessage({message:"exam_window_closed"});chrome.runtime.sendMessage({message:"close_webcam",type:"relaunch"})}window.addEventListener("beforeunload",handleBeforeUnloadEvent);if(window.parent!==window)window.top.addEventListener("beforeunload",handleBeforeUnloadEvent)}function formatLinks(){var links=$(".takeQuestionDiv a:not(.hidden)");links.attr("target","_blank");links.attr("rel","noreferrer noopener")}document.addEventListener("launchcam",(function(){launchWebCamera()}));document.addEventListener("relaunchcam",(function(){chrome.runtime.sendMessage({message:"webcam_launch",url:hl_url+"/webapp/camera",session_id:session_id,lms_id:1,relaunch:1,display_count:display_count,current_url:window.location.hostname})}))}function applySubmitLogic(){chrome.runtime.sendMessage({message:"disable_browser_guard"});chrome.runtime.sendMessage({message:"close_webcam",type:"submit"})}function waitForElement(element,callback){let poll_interval=setInterval((function(){if($(element).length){clearInterval(poll_interval);poll_interval=null;if(callback&&"function"==typeof callback){callback(true);return true}}}),100);$((function(){setTimeout((function(){if(poll_interval){callback(false);clearInterval(poll_interval)}}),1e4)}))}function getEnvInfo(callback){top.env={};var context_variables=["context","user","course","content","session"];var exclude_list={context:[],user:["BirthDate","BusinessFax","BusinessPhone1","BusinessPhone2","CDRomDriveMac","CDRomDrivePC","CalendarType","City","CloudAvatarURL","CloudId","Company","Country","Department","EducationLevel","Gender","HomeFax","HomePhone1","HomePhone2","JobTitle","LastLoginDate","MiddleName","MobilePhone","OtherName","Password","PortalRole","Registry","RowStatus","ShowAddContactInfo","ShowAddressInfo","ShowEmailInfo","ShowWorkInfo","State","Street1","Street2","StudentId","Suffix","WebPage","WeekFirstDay","ZipCode"],course:["AbsoluteLimit","AllowGuests","AllowObservers","AsmtUpgradeFlags","AsmtUpgradeVersion","BannerImageFile","ButtonStyle","ButtonStyleId","CartridgeId","Classification","ClassificationId","ConvertTaskId","CopyFromUuid","CourseThemeId","EnrollmentAccessCode","Fee","HasDescriptionPage","HonorTermAvailablity","ImportTaskId","NavColorBg","NavColorFg","NumDaysOfUse","Registry","RowStatus","ShowInCatalog","SoftLimit","UploadLimit"],content:["AllowGuests","AllowObservers","ContentHandler","CopyFromId","Custom","DataVersion","ExtendedData","Folder","FolderType","IsDescribed","IsFromCartridge","IsGroupContent","IsLesson","IsReviewable","IsSampleContent","IsSequential","IsTracked","LinkRef","OfflineName","OfflinePath","ParentId","PartiallyVisible","Position","RenderType","TextFormat","TitleColor","UrlHost"],session:["FileOneTimeHash","FileServerHash","Fingerprint","IdHash","IdSecureHash","OneTimeToken"]};for(var x=0;x<context_variables.length;x++){var var_name=context_variables[x];var element="#"+var_name+"Info";var dump=$(element).html();if(!dump)continue;var arr=dump.split("\n");if(1==arr.length)arr=dump.split(",");var result={};var i;for(i=0;i<arr.length;i++){var split=arr[i].split(": ");if(2!=split.length||exclude_list[var_name].indexOf(split[0])>-1)continue;else{if("id"==split[0]&&"PkId"==split[1].substring(0,4)){var start=split[1].indexOf("key=");split[1]=split[1].substring(start+4,split[1].indexOf(",",start))}result[split[0].replace(/\s/g,"")]=split[1]}}env[var_name]=result;if(i>=arr.length)$(element).remove()}var school_info={id:$("#schoolInfo").data("id"),name:$("#schoolInfo").data("name")};env["school"]=school_info;$("#schoolInfo").remove();callback(true)}function getChromeVersion(){var raw=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return raw?parseInt(raw[2],10):false}function showCalculator(calculatorType){$("#hl-calculator").show();if("object"===typeof hlExamTools)hlExamTools.proctorAddCalculatorToExam(calculatorType)}function toggleCalculator(setActiveState=null,forceFocus=true){if("object"===typeof hlExamTools)hlExamTools.toggleCalculator(setActiveState,forceFocus)}function hideCalculators(){$("#hl-calculator").hide();if("object"===typeof hlExamTools)hlExamTools.proctorRemoveCalculatorFromExam()}function adjustWebcamPositionForChat(isActive){if("object"===typeof hlExamTools)hlExamTools.adjustWebcamPositionForChat(isActive)}function toggleWebcamVisibilty(shouldBeVisible){if("object"===typeof hlExamTools)hlExamTools.toggleWebcam(shouldBeVisible)}function toggleWebcamCompressed(shouldBeCompressed){if("object"===typeof hlExamTools)hlExamTools.toggleWebcamCompressed(shouldBeCompressed)}function insertWebFont(){$("head").append('<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">')}function sendLivechatMsg(msg){$("head").append(`\n\t\t<script>\n\t\t\tLiveChatWidget.call('maximize')\n\t\t<\/script>\n    `)}function insertLiveChat(student_name,hl_student_id,exam_id,school_code="Not provided",page,exam_toggles){const hlChatParameters={lmsSchoolId:school_code,examId:exam_id,studentId:hl_student_id,lmsStudentName:student_name,lmsStudentEmail:hl_student_id,license:livechat_license,withExamTools:true};hlChat.init(hlChatParameters);document.addEventListener("enableguard",(function(){chrome.storage.local.set({guardModeStatus:1});chrome.runtime.sendMessage({message:"enable_browser_guard"});chrome.runtime.sendMessage({message:"disable_new_tabs"});chrome.runtime.sendMessage({message:"begin_fullscreen"});chrome.runtime.sendMessage({message:"to_camera",msg:"enable_guard_camera"})}));document.addEventListener("focuschat",(function(){chrome.runtime.sendMessage({message:"focus_page"})}));document.addEventListener("cleanslate",(function(){chrome.storage.local.clear()}));document.addEventListener("disableguard",(function(){chrome.runtime.sendMessage({message:"disable_browser_guard"})}));document.addEventListener("opensesame",(function(){chrome.runtime.sendMessage({message:"bypass_payment"})}));document.addEventListener("nextstep",(function(){chrome.runtime.sendMessage({message:"livechat_command_nextstep"})}));document.addEventListener("cyclevideo",(function(){chrome.runtime.sendMessage({message:"cyclevideo"})}));document.addEventListener("exitfullscreen",(function(){chrome.runtime.sendMessage({message:"exit_fullscreen"});chrome.storage.local.set({fullscreen_override:1})}));document.addEventListener("showcalculator",(()=>showCalculator("basic")));document.addEventListener("showcalculatorsci",(()=>showCalculator("scientific")));document.addEventListener("hidecalculators",(()=>hideCalculators()));document.addEventListener("opencalculator",(()=>toggleCalculator(true)));document.addEventListener("opencalculatorsci",(()=>toggleCalculator(true)));document.addEventListener("closecalculators",(()=>toggleCalculator(false,false)));document.addEventListener("chat-started",(()=>adjustWebcamPositionForChat(true)));document.addEventListener("chat-ended",(()=>adjustWebcamPositionForChat(false)));document.addEventListener("showwebcam",(()=>toggleWebcamVisibilty(true)));document.addEventListener("hidewebcam",(()=>toggleWebcamVisibilty(false)));document.addEventListener("compresswebcam",(()=>toggleWebcamCompressed(true)));document.addEventListener("expandwebcam",(()=>toggleWebcamCompressed(false)))}function insertExamTools(isExamBegin){if("object"===typeof hlExamTools){const isExamUsingWebcam=1===parseInt(exam_toggles[1]["value"]);hlExamTools.init({environmentUrl:hl_url,activeLms:"blackboard",isExamBegin:isExamBegin,isExamUsingWebcam:isExamUsingWebcam,translations:translations})}}