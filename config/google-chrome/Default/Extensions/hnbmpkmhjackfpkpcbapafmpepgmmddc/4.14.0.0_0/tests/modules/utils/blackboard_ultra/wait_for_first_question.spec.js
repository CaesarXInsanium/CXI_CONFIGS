require("../../../../modules/utils/blackboard_ultra/wait_for_first_question");describe("waitForFirstQuestion",(()=>{afterEach((()=>{jest.useRealTimers()}));it("Will call callback function with first question once loaded",(()=>{let callback=jest.fn();document.body.innerHTML=`\n      <iframe id="lti-launch-iframe">\n      </iframe>\n    `;document.getElementById("lti-launch-iframe").contentWindow.document.body.innerHTML=`\n                  <bb-assessment-question>\n              <div class="question-container">\n                <div role="presentation">\n                    <p>Question 1</p>\n                </div>\n            </div>\n          </bb-assessment-question>\n                  <bb-assessment-question>\n              <div class="question-container">\n                <div role="presentation">\n                    <p>Question 2</p>\n                </div>\n            </div>\n          </bb-assessment-question>\n`;let firstQuestion=document.getElementById("lti-launch-iframe").contentWindow.document.querySelectorAll("bb-assessment-question")[0];waitForFirstQuestion(callback);expect(callback).toBeCalledWith(firstQuestion)}));it("Will find first question if exam is not in iframe",(()=>{let callback=jest.fn();document.body.innerHTML=`\n        <bb-assessment-question>\n              <div class="question-container">\n                <div role="presentation">\n                    <p>Question 1</p>\n                </div>\n            </div>\n          </bb-assessment-question>\n                  <bb-assessment-question>\n              <div class="question-container">\n                <div role="presentation">\n                    <p>Question 2</p>\n                </div>\n            </div>\n          </bb-assessment-question>\n        `;const firstQuestion=document.querySelectorAll("bb-assessment-question")[0];waitForFirstQuestion(callback);expect(callback).toHaveBeenCalledWith(firstQuestion)}));it("Will retry if security error",(()=>{jest.useFakeTimers();let callback=jest.fn();document.body.innerHTML=`\n          <iframe id="lti-launch-iframe">\n          </iframe>\n        `;const examIFrame=document.getElementById("lti-launch-iframe");examIFrame.contentWindow.document.querySelectorAll=jest.fn((()=>{throw new DOMException(null,"SecurityError")}));waitForFirstQuestion(callback);expect(setTimeout).toHaveBeenCalled()}));it("will throw error if not a security error",(()=>{let callback=jest.fn();document.body.innerHTML=`\n          <iframe id="lti-launch-iframe">\n          </iframe>\n        `;const examIFrame=document.getElementById("lti-launch-iframe");examIFrame.contentWindow.document.querySelectorAll=jest.fn((()=>{throw new DOMException}));expect((()=>{waitForFirstQuestion(callback)})).toThrowError(DOMException)}))}));