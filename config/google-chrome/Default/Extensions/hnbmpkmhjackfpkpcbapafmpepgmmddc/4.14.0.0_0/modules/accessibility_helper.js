class AccessibilityHelper{constructor(){this._eventHandlersMemo={}}setupAccessibleTabFocusListener(memoIndex,domElement,focusInCallback,focusOutCallback){if(domElement){const events=["focusin","focusout"];for(const event of events)domElement.addEventListener(event,this._handleAccessibleTabFocusEvent(`${memoIndex}-${event}`,focusInCallback,focusOutCallback))}}detachAccessibleTabFocusListener(memoIndex,domElement,focusInCallback,focusOutCallback){if(domElement){const events=["focusin","focusout"];for(const event of events){const memoRef=`${memoIndex}-${event}`;domElement.removeEventListener(event,this._handleAccessibleTabFocusEvent(memoRef,focusInCallback,focusOutCallback));this._eventHandlersMemo[memoRef]=null}}}_handleAccessibleTabFocusEvent(memoIndex,focusInCallback,focusOutCallback){return this._eventHandlersMemo[memoIndex]||(this._eventHandlersMemo[memoIndex]=event=>{"focusin"===event.type?focusInCallback():focusOutCallback()})}setupAccessibleClickEventListener(memoIndex,domElement,callback){if(domElement){const events=["click","keypress"];for(const event of events)domElement.addEventListener(event,this._handleAccessibleClickEvent(`${memoIndex}-${event}`,callback))}}detachAccessibleClickEventListener(memoIndex,domElement,callback){if(domElement){const events=["click","keypress"];for(const event of events){const memoRef=`${memoIndex}-${event}`;domElement.removeEventListener(event,this._handleAccessibleClickEvent(memoRef,callback));this._eventHandlersMemo[memoRef]=null}}}_handleAccessibleClickEvent(memoIndex,callback){return this._eventHandlersMemo[memoIndex]||(this._eventHandlersMemo[memoIndex]=event=>{if(true===this._a11yClick(event))callback(event)})}_a11yClick(event){if("click"===event.type&&(event.clientX||event.clientY))return true;if("keypress"===event.type){let code=event.charCode||event.keyCode;if(32===code||13===code){event.stopPropagation();event.preventDefault();return true}}return false}toggleElementAccessibilityState(element,elementToggle,isActive,forceFocus=false){if(isActive){if(forceFocus)element.focus();element.setAttribute("aria-hidden","false");elementToggle.setAttribute("aria-expanded","true");return}element.blur();elementToggle.blur();element.setAttribute("aria-hidden","true");elementToggle.setAttribute("aria-expanded","false")}applyFocusVisiblePolyfill(scope){let hadKeyboardEvent=true;let hadFocusVisibleRecently=false;let hadFocusVisibleRecentlyTimeout=null;const inputTypesAllowList={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};const pointerMoveListeners=["mousemove","mousedown","mouseup","pointermove","pointerdown","pointerup","touchmove","touchstart","touchend"];function _isValidFocusTarget(element){return element&&element!==document&&"HTML"!==element.nodeName&&"BODY"!==element.nodeName&&"classList"in element&&"contains"in element.classList}function _focusTriggersKeyboardModality(element){let type=element.type;let tagName=element.tagName;if("INPUT"===tagName&&inputTypesAllowList[type]&&!element.readOnly)return true;if("TEXTAREA"===tagName&&!element.readOnly)return true;return element.isContentEditable}function _addFocusVisibleClass(element){if(element.classList.contains("focus-visible"))return;element.classList.add("focus-visible");element.setAttribute("data-focus-visible-added","")}function _removeFocusVisibleClass(element){if(!element.hasAttribute("data-focus-visible-added"))return;element.classList.remove("focus-visible");element.removeAttribute("data-focus-visible-added")}function _onKeyDown(event){if(event.metaKey||event.altKey||event.ctrlKey)return;if(_isValidFocusTarget(scope.activeElement))_addFocusVisibleClass(scope.activeElement);hadKeyboardEvent=true}function _onPointerDown(){hadKeyboardEvent=false}function _onFocus(event){if(!_isValidFocusTarget(event.target))return;if(hadKeyboardEvent||_focusTriggersKeyboardModality(event.target))_addFocusVisibleClass(event.target)}function _onBlur(event){if(!_isValidFocusTarget(event.target))return;if(event.target.classList.contains("focus-visible")||event.target.hasAttribute("data-focus-visible-added")){hadFocusVisibleRecently=true;window.clearTimeout(hadFocusVisibleRecentlyTimeout);hadFocusVisibleRecentlyTimeout=window.setTimeout((function(){hadFocusVisibleRecently=false}),100);_removeFocusVisibleClass(event.target)}}function _onVisibilityChange(){if("hidden"===document.visibilityState){if(hadFocusVisibleRecently)hadKeyboardEvent=true;_addInitialPointerMoveListeners()}}function _addInitialPointerMoveListeners(){pointerMoveListeners.forEach((listener=>{document.addEventListener(listener,_onInitialPointerMove)}))}function _removeInitialPointerMoveListeners(){pointerMoveListeners.forEach((listener=>{document.removeEventListener(listener,_onInitialPointerMove)}))}function _onInitialPointerMove(event){if(event.target.nodeName&&"html"===event.target.nodeName.toLowerCase())return;hadKeyboardEvent=false;_removeInitialPointerMoveListeners()}document.addEventListener("keydown",_onKeyDown,true);document.addEventListener("mousedown",_onPointerDown,true);document.addEventListener("pointerdown",_onPointerDown,true);document.addEventListener("touchstart",_onPointerDown,true);document.addEventListener("visibilitychange",_onVisibilityChange,true);_addInitialPointerMoveListeners();scope.addEventListener("focus",_onFocus,true);scope.addEventListener("blur",_onBlur,true);if(scope.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&scope.host)scope.host.setAttribute("data-js-focus-visible","");else if(scope.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}}globalThis.hlA11yHelper=new AccessibilityHelper;