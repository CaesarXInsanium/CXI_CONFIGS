export default class InjectDisableCopyPaste{constructor(){this._injectedFrames=new Set}init(){this._setupEventListeners()}remove(){this._detachEventListeners();this._injectedFrames.clear()}_setupEventListeners(){if(!chrome.webNavigation.onCompleted.hasListener(this._handleNavigationOnCompleteEvent))chrome.webNavigation.onCompleted.addListener(this._handleNavigationOnCompleteEvent);if(!chrome.webNavigation.onBeforeNavigate.hasListener(this._handleOnBeforeNavigateEvent))chrome.webNavigation.onBeforeNavigate.addListener(this._handleOnBeforeNavigateEvent)}_detachEventListeners(){if(chrome.webNavigation.onCompleted.hasListener(this._handleNavigationOnCompleteEvent))chrome.webNavigation.onCompleted.removeListener(this._handleNavigationOnCompleteEvent);if(chrome.webNavigation.onBeforeNavigate.hasListener(this._handleOnBeforeNavigateEvent))chrome.webNavigation.onBeforeNavigate.removeListener(this._handleOnBeforeNavigateEvent)}_handleNavigationOnCompleteEvent=event=>{const tabId=event.tabId;const frameId=event.frameId;const frameUrl=event.url;if("about:blank"===frameUrl||this._injectedFrames.has(frameUrl))return;this._injectedFrames.add(frameUrl);chrome.tabs.executeScript(tabId,{file:"modules/disable_copy_paste.js",frameId:frameId,runAt:"document_start"})};_handleOnBeforeNavigateEvent=event=>{if(this._injectedFrames.has(event.url)){this._injectedFrames.delete(event.url);return}this._injectedFrames.forEach((url=>{if(event.url.indexOf(url)>-1)this._injectedFrames.delete(url)}))}}